<app-page [title]="titleForm">
  <div class="card bg-dark">
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="nomeCompleto">Nome Completo</label>
          <input type="text" class="form-control"
            [class.is-invalid]="form.get('nomeCompleto')?.touched && form.get('nomeCompleto')?.invalid"
            id="nomeCompleto" formControlName="nomeCompleto" placeholder="Digite seu nome completo">

          @if(form.get('nomeCompleto')?.touched && form.get('nomeCompleto')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('nomeCompleto')?.errors?.['required']){
            <div>
              O nome completo é obrigatório.
            </div>
            }
            @if(form.get('nomeCompleto')?.errors?.['minlength']){
            <div>
              O nome deve ter no mínimo {{ form.get('nomeCompleto')?.errors?.['minlength']?.requiredLength }}
              caracteres.
            </div>
            }

          </div>
          }
        </div>

        <div class="form-group">
          <label for="cpf">CPF</label>
          <input type="text" class="form-control" id="cpf" formControlName="cpf" placeholder="Digite seu CPF"
            [class.is-invalid]="form.get('cpf')?.touched && form.get('cpf')?.invalid">
          @if(form.get('cpf')?.touched && form.get('cpf')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('cpf')?.errors?.['required']){
            <div>
              O CPF é obrigatório.
            </div>
            }
            @if(form.get('cpf')?.errors?.['cpfInvalido']){
            <div>
              O CPF é inválido. ex:19218898310
            </div>
            }
          </div>

          }
        </div>

        <div class="form-group">
          <label for="dataNascimento">Data de Nascimento</label>
          <input type="date" class="form-control"
            [class.is-invalid]="form.get('dataNascimento')?.touched && form.get('dataNascimento')?.invalid"
            id="dataNascimento" formControlName="dataNascimento">

          @if(form.get('dataNascimento')?.touched && form.get('dataNascimento')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('dataNascimento')?.errors?.['required']){
            <div>
              A data de nascimento é obrigatória.
            </div>
            }
            @if(form.get('dataNascimento')?.errors?.['invalidDate']){
            <div>
              A data de nascimento é inválida.
            </div>
            }
            @if(form.get('dataNascimento')?.errors?.['futureDate']){
            <div>
              A data de nascimento não deve ser superior a hoje.
            </div>
            }
          </div>
          }
        </div>

        @if(id){
        <div class="form-group">
          <label for="dataCadastro">Data de Cadastro</label>
          <input type="datetime-local" class="form-control"
            [class.is-invalid]="form.get('dataCadastro')?.touched && form.get('dataCadastro')?.invalid"
            id="dataCadastro" formControlName="dataCadastro">

          @if(form.get('dataCadastro')?.touched && form.get('dataCadastro')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('dataCadastro')?.errors?.['required']){
            <div>
              A data de cadastro é obrigatória.
            </div>
            }
            @if(form.get('dataCadastro')?.errors?.['invalidDate']){
            <div>
              A data de cadastro é inválida.
            </div>
            }
            @if(form.get('dataCadastro')?.errors?.['futureDate']){
            <div>
              A data de cadastro não deve ser superior a hoje.
            </div>
            }
          </div>
          }
        </div>
        }

        <div class="form-group">
          <label for="plano">Plano</label>
          <select class="form-control" [class.is-invalid]="form.get('planoId')?.touched && form.get('planoId')?.invalid"
            id="plano" formControlName="planoId">
            <option value="">Selecione um plano</option>
            @for(plano of planos; track plano.id){
            <option [value]="plano.id">
              {{ plano.nome }}
            </option>
            }
          </select>

          @if(form.get('planoId')?.touched && form.get('planoId')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('planoId')?.errors?.['required']){
            <div>
              O plano é obrigatório.
            </div>
            }
          </div>
          }
        </div>

        <div class="form-group">
          <label for="status">Status</label>
          <select class="form-control" [class.is-invalid]="form.get('status')?.touched && form.get('status')?.invalid"
            id="status" formControlName="status">
            <option value="ATIVO">ATIVO</option>
            <option value="INATIVO">INATIVO</option>
          </select>

          @if(form.get('status')?.touched && form.get('status')?.invalid){
          <div class="invalid-feedback">
            @if(form.get('status')?.errors?.['required']){
            <div>
              O status é obrigatório.
            </div>
            }
          </div>
          }
        </div>

        <div class="buttons d-flex justify-content-end align-item-center">
          <button type="submit" class="btn btn-primary" [disabled]="form.invalid || form.pristine" id="submit">
            Salvar
          </button>
          <button class="btn btn-secondary" [disabled]="form.pristine" (click)="onCancel()" type="button" id="cancel">
            Cancelar
          </button>
        </div>

      </form>
    </div>
  </div>
</app-page>
